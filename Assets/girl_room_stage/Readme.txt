この度はMMDステージモデル、女の子の部屋をダウンロードしてくださりありがとうございます。

モデルについて何か不具合を見つけたり、
動画作成においてこういう機能があると助かるなど、
ご意見・ご感想、不具合などございましたらTwitterか
fantiaの記事コメント、メッセージ機能にてお寄せください。
わたしの技術的に出来そうな範囲で取り込んでいきたいと思います。

本モデルは、クリエイティブコモンズ4.0 表示 - 継承 4.0 国際 (CC BY-SA 4.0) です。
https://creativecommons.org/licenses/by-sa/4.0/deed.ja

細かい利用規約は、別添の利用規約テキストをご覧下さい。


こちらでは、主にモデルの機能紹介を。


[機能紹介]
　ボーン構造：基本的な家具類にボーンを仕込んであります。
		ローカル軸も設定済みですので、ステージ自体を回転した後でも動かしやすいはずです。

　扉類：部屋の入り口のドアは内開きです。
	ボーンの位置を内開き用にしてありますので、ローカル軸モードでY軸回転してください。
	ドアノブも回せます。
	クローゼットは引き戸です。ボーンをX軸移動してください。

　窓類：出窓は開けられるようにするとあれこれ面倒なので、はめ殺し仕様です。
	普通タイプの窓はZ軸移動で動かせます
	廊下の窓はヒンジが上に付いているタイプです。
	X軸回転で外向きに開けるのが基本ですが、Y軸回転でも結構それっぽいです。

　ベッド：ベッドボーンを親に、マットレス兼シーツ、ベッドサイドの小物が子になっています。
	物理演算による接触判定用の物理剛体は2つ。
	ベッドサイドはベッドボーン、シーツ部分はシーツボーン追従です。
	何にとは敢えて言いませんが、ベッドを上下に揺らす表現をする場合は
	シーツボーンを上下させてください。

　枕：大きくしたり、厚くしたり、寝て頭が乗ってるときの凹みのモーフ付きです。

　ベッドサイドの時計：長針と短針別々にボーンを仕込んであります。
	ローカルY軸回転で回せます。デフォルトで9時00分の位置です。
	時間経過の演出などにご利用ください。

　ランプ類：ベッドサイドランプ、デスクライト、シーリングライト、廊下の照明、
	ドア中央部の擦りガラス(っぽいものとして)はAutoLuminous4対応です。
	想定した色で光らせるため材質差し替え型です。
	～ALモーフで切り替えた後、同名のAL+で光量を変えてください。
	ドアのは、廊下側or部屋内の光が漏れている表現用です。

　引き出し類：ベッドサイドの収納部分、勉強机、ドレッサー、ラックの下2段分に入っている箱は
	それぞれ動かすことが出来ます。
	ベッドサイドのだけは回転で開けるためボーンモーフを付けていますが、
	ボーンモーフを使わずともローカル軸で回転させれば動かせます。
	引き出しの中には何も入れていませんので、そういった演出をする際は、
	それぞれの引き出しボーンを外部親するなどして、別のモデルを仕込むといいかもしれません。

　ポスター・コルクボードの写真：
	基本的に差し替え前提のものになります。
	暫定として昔わたしが書いたイラストを設定してあります。
	静止画・動画作品ごとに、内容に合わせたものに差し替えるのがお勧めです。
	UVの透過PNGを同梱（ファイル末尾に_UVと付いている）してありますので、それに合わせて差し替えてください。
	支援者限定配布版のみテクスチャのPSDファイルが同梱されていますので、
	その場合はそれを読んで編集して頂ければ楽できるはずです。
	ポスターのみ個別にボーン仕込んであります。

　本類：これも割と差し替え前提ですが、タイトル考えるの大変だと思いますので、
	適宜差し替えるなどしてください。

　カーテン：開閉は材質の差し替え式です。
	レースカーテンは開け閉めできません。

　家電類：エアコンのルーバー、部屋の入り口の室内電灯用スイッチはボーンで動かせます。
	スイッチは余程アップで映さないと動いたかどうか分かりづらいですが一応。

　家具の高さ変更：ベッド、勉強机、椅子は高さの変更が可能です。
	ボーンモーフと頂点モーフを組み合わせたグループモーフです。
	椅子については、まず机に合わせて高くなるので、
	その分を下げるモーフを仕込んであります。
	モデルに合わせて調整してみてください。
	接触判定用の剛体もボーンモーフなので動きます。

　壁の方角：木造2階建て建築、2階の南西側の部屋として制作しています。
	出窓があるのが南、もう一つの窓が西側です。
	あくまで、創作上の想定ですので参考程度に。

　部屋の広さ変更：先ほどの方角で言う、東側の壁のみ広げられます。
	壁と天井だけの頂点モーフです。
	カメラワークの都合で広げたり、広げてから家具を動かせば間取りをある程度変更できます。

　鏡類：針金P氏作 MirrorWFに対応させました。
	正確には、対応させたエフェクトファイルを同梱してあります。
	Mirror_WFフォルダ内のgirls_room_mirror_d.x(ドレッサーの鏡)、
	girls_room_mirror_s.x(姿見の鏡)をそれぞれ読み込んでください。
	ただし、そのままでは部屋の全体の回転や、それぞれの鏡があるボーンで動かした場合には
	追従できません。
	アクセサリ操作パネルから、それぞれのxを女の子の部屋の全ての親ボーンに
	外部親登録してください。
	ただし、二枚も鏡面があるととても重いです。カットによって上手く使い分けてください。
	元の鏡と全く同じ位置に鏡面がありますので、鏡の透明度を変更しない場合は、
	元の鏡の材質をMMEでオフにしてください。
	透過度を変更する場合は、ドレッサーの場合Xを-0.001に、
	姿見はXとZを-0.001にして少しずらすと、重なり合ったときの変な描画から解放されます。
	問題は、MirrorWFは使用の都合でシェーダー系エフェクトやES2辺りのエフェクトであっても、
	反射された像には反映されません。
	一部のエフェクトにはこの問題に対処したバージョンが公開されていますので、
	探してみるのもいいでしょう。
	ただ、あまり鏡をアップで映してというカットを作らない限り、
	現状でも十分雰囲気作りに役立ちます。

	ビームマンPのポスト映り込みエフェクトでも反射しますが、
	近距離のオブジェクトしか映らないので、シーンに合わせてどちらのエフェクトを使うか
	変えてみてください。


[Q&A]
　Q：テレビは何処へ？
　A：間取りの都合で置く場所が無くなりました…
　　あと、今の時代だとスマホで済ませる子の方が多いらしいので、そういう感じの設定と言うことで。
　　動画内でTV画面に映したりしたい場合は、girls_room_mirror_d.xをリネームして使い、
　　ドレッサーの鏡を映す先にするのがいいかもしれません。


[現状出ているNVIDIA系グラフィックカードにおける描画の不具合について]
　この件、割と有名なバグなんですが、今までお借りしたモデルだったり、
　ルティのVer.1、2ともに出なかったので油断していたところ、
　アンチエイリアスをオンにすると、ポリゴンの境目に意図しない線が出る問題が発生し、
　モデル側での対策法が未だ確立されていないため、こちらの記事にある検証用セットに同梱されている、
　16bitTexDraw.xを読み込ませ、アクセサリ描画順最上段にすることで解決させています。
　https://seiga.nicovideo.jp/seiga/im4585854

　NVIDIA系グラフィックカードをご使用の環境で、この症状が出た場合、
　先の記事から検証用セットをDLして、16bitTexDraw.xを使ってください。
　わかりやすい部分は、ドレッサーの机部分や、アップに映した場合のメイクボックスの把手です。
　この手法を使っても、MirrorWFを使った鏡像では出てしまいますので、
　こちらについては、同梱のエフェクトファイルはそうならないように修正済みです。


[影について]
　MMDの標準光源は、距離を考慮しない平行投影型光源です。
　この仕様のため、標準の光源動かすと室内のステージモデルでは結構な割合で、
　壁際のオブジェクトに関する変な影が出来ます。
　それの対策のため、壁にくっついている、それに近いオブジェクトの材質は、
　影を投影しない設定にしてあります。
　出窓の部分は特に変になりやすかったので、光源が標準位置の時に自然な影が落ちるよう、
　影投影用のダミーを置いています。要らない場合はモーフで消すか、PMXEで消してしまってください。

　基本的にはシーリングライトの位置のように、直上にするか、少しだけ傾けるのがおすすめです。
　窓からの日光は、スカイドームとの組み合わせと、追加光源系エフェクトで表現をするのがお勧めです。


[テクスチャ表現について]
　MMDのステージとして基本的に採用されている、あまり影類を描き込まないタイプです。
　のっぺりとしてしまいがちなので、アンビエントオクルージョン(AO)系エフェクト仕様推奨です。


[ExcellentShadow2について]
　動画中にカーテンの開け閉めなど材質モーフ系の変更を行うと、
　材質モーフの関係で変な表示になる場合があります。
　ExcellentShadow2にて症状確認済みです。この場合、上記の材質にだけはES2を使わず、
　MMDShadowを使用してみてください。ES2と同時使用でも問題ないことを確認済みです。
　HgShadowでもいいのですが、セルフシャドウの処理が違うため違和感が出ます。
　MMD標準のセルフ影では問題ないため、同様の処理をしつつソフトシャドウ化されている、
　MMDShadowが適任かと思います。
　本モデルにおける初期状態での非表示材質は、カーテンを閉じた物、ランプ類のAL発光色用材質です。

　また、ES2は材質に設定されている影を投影するかしないかの設定を無視して強制的に影を作ります。
　その対策として、MMEのExcellentShadowZMapタブにて、該当材質の割り当て解除、
　チェックを外して非表示にすると影が消えます。
　こちらで調整したエフェクト割り当てのemdファイルを同梱してありますので、
　MMEでExcellentShadowZMapタブに移動し、girls_room.pmxを選択し、
　ファイルメニューからモデル単位で設定読み込み→ES2_ZMap.emdを読み込んでください。


[窓の外のスカイドーム表示について]
　スカイドームは同梱してありませんので、お好きなのをご利用ください。
　ただ、描画順が弄れないx形式のスカイドームですと、窓が上手く透過してくれません。
　PMX形式のスカイドームであれば描画順を弄れば綺麗に外が映ります。


[物理設定について]
　ベッドの項目にも書きましたが、当たり判定用の剛体をあった方がよさそうなものにだけ
　設定してあります。
　ボーン追従の剛体で、グループは1番です。
　必要が無かったり、グループの都合がある場合はそれぞれPMXEで設定を変えてみてください。

　仕込んであるのは、ベッド、枕、クッション類、机(天板のみ)、椅子(座面のみ)、
　ラック、ドレッサーです。


[Ray-MMDなどの統合型シェーダについて]
　MMDの動画作成については自分は初心者もいいところですので、
　MMEなどにおいて、マテリアルの設定がどう競合するか、まだに詰め切れておりません。
　AL系以外の材質は、拡散色(1,1,1)、反射色(0,0,0)、環境色(0.5,0.5,0.5)、
　反射強度(5.0)で統一してあります。　


[製作コンセプトなど]
　本モデルは、nya氏製作・灰色氏改造の「ふつーの部屋」を一度動画で使用しとても気に入ったけれども、
　かゆいところに手が届かない感があったため、間取りをおおまかに維持したまま、
　影の問題、生活感を出すための多数のオブジェクトの追加して、
　女の子の私室をイメージしたデザインとしてフルスクラッチしたモデルになります。
　女子中学生～女子高校生くらいの子の部屋をイメージしています。
　というか、元ネタとして参考にさせて頂いた、某JKアイドルキャラの私室なので、
　ドレッサーやコスメ、そのための姿見などがあるのが特徴です。

　日本の女子の部屋ですからたいした広さがありませんので、ダンス向きではありませんね…
　日常の小芝居、あるいはR-18なシチュエーションでのご利用向けです。

　というか、主にそっちが主な目的ですね。鏡もありますし、是非そのシチュでご使用頂ければと。

　また、できる限りBlenderとaddonのmmd_toolsで出力するだけで使えるPMXを書き出せる、
　をコンセプトに製作しました。剛体入れもmmd_toolsのみです。


[改変について]
　最初に書きましたとおり、クリエイティブコモンズライセンスです。
　動画に合わせて改造したり、それを公開したりすることが可能です。

　改変後、再配布の際は必ず本モデル改造モデルであることを明記してください。
　他のステージモデルへのパーツ取りの場合であっても同様です。

　改変モデルの公開は、可能であれば、ニコニコモンズのコンテンツツリーへご登録ください。

　動画についても、コンテンツツリーに登録して頂ければありがたいです。
　ただ、iwaraなどに投稿するような動画の場合は無理ですので、
　動画内、もしくは動画の説明欄には本モデル名を必ず記載してください。


[今後の予定]
・不具合の修正


[更新履歴]
　2020/06/11　Ver.1.00β公開

　2020/06/18　Ver.1.00 正式リリース
	ねこクッションの剛体がボーン追従になっていないのを修正。
	シーリングライト、コルクボードにボーンを追加。動かせます。
	コーナーラックに剛体追加。
	机の脇に学生鞄を追加。
	学生服を衣装掛けに追加。ハンガーのサイズを衣装に合わせて小さく。
	机の上、出窓の棚の上、ドレッサーの上に外部親登録用のボーンと追加。アクセサリ追加時にどうぞ。
	
 2023/08/02　Ver.1.02
 	出窓の観葉植物のウェイトが他と重複していたために起きていた問題を修正。

 2023/08/05 Ver.1.02a
 	テクスチャの相対パス指定が間違っていた点を修正。

 2024/05/21 Ver.1.04
	ドレッサーの上の化粧品の一つが動かなかった問題を修正。
	シーリングライトのALオン時、シーリングライト拡大のモーフが動いてなかった問題を修正。
	ポスターそれぞれにボーンを設定。壁を移動する頂点モーフと同期しないので、ボーンで動かしてください。
	枕にモーフを追加。
	カーテンを閉じるモーフで閉じた際、中央に隙間がないように修正。
	マテリアルの追加はありませんので、エフェクト設定ファイルには互換性があるはずです。


作者          ：ゆーね

Twitter     ：https://twitter.com/lutiel
Misskey.io  ：https://misskey.io/@lutiel
Fantia      ：https://fantia.jp/lutiel
BowlRoll    ：https://bowlroll.net/user/474387